---
title: "RoadAccidentSeverity"
author: "Alexandre Robin"
date: "`r Sys.Date()`"
output: rmdformats::material
---

```{r setup, echo=False, include=FALSE}

require(dplyr, install.packages('dplyr'))
require(knitr, install.packages('knitr'))
require(ggplot2, install.packages('ggplot'))
require(naniar, install.packages('naniar'))
require(rmdformats, install.packages('rmdformats'))
require(tidyr, install.packages('tidyr'))
require(visdat, install.packages('visdat'))

knitr::opts_chunk$set(echo = TRUE)
```

```{r}
boxplot <- function(data, target, var){
  ggplot(data, aes(y=data[,target], x=data[,var],colour=data[,var],fill=data[,var]))+
  geom_boxplot(alpha=0.5, outlier.alpha=0)+geom_jitter(width=0.25)+
  stat_summary(fun=mean, colour="black", geom="point",shape=18, size=2)+
  scale_color_discrete(name=var) + scale_fill_discrete(name=var)+
  labs(x=var, y=target, title = paste(target, "vs", var))
}

plot_multi_var <- function(train, target, var_quant, var_qual){
  ggplot(train, aes_string(x = var_quant, y =target, color=var_qual)) +
  geom_point()+geom_smooth(method = "lm")
}

boxplot_mano <- function(df, target, var, both=T){
    data <- df
    data[,var] <- data[,var] %>% as.character
    
    g <- ggplot(data, aes(data[,var], colour=data[,var], fill=data[,var])) +
      geom_bar() +
      scale_color_discrete(name=var) + scale_fill_discrete(name=var)+
      labs(x=var)
    print(g)
    
    g <- ggplot(data, aes(y=data[,target], x=data[,var], colour=data[,var], fill=data[,var])) +
      geom_boxplot(alpha=0.5, outlier.alpha=0)+geom_jitter(width=0.25)+
      stat_summary(fun=mean, colour="black", geom="point",shape=18, size=3)+
      scale_color_discrete(name=var) + scale_fill_discrete(name=var)+
      labs(x=var, y=target, title = paste(target, "vs", var))
    print(g)
}

hist_and_density <- function(data, var, binwidth=10){
  ggplot(data, aes(x=data[,var])) +
    geom_histogram(aes(y=..density..), 
                   colour=1, 
                   fill='white',
                   binwidth=binwidth) +
    geom_density(alpha=.2, fill="#FF6666") +
    labs(x=var, title = paste(var, "distribution"))
  
}
```


# Exploratory Data Analysis

```{r}
original_data <- read.csv2('aggregated_data.csv')
data <- original_data

```


## Target

```{r}
target_name <- 'grav' 
target <- usagers[,target_name]

data <- usagers
var <- target_name

g <- ggplot(data, aes(data[,var], colour=data[,var], fill=data[,var])) +
    geom_bar() +
    scale_color_discrete(name=var) + scale_fill_discrete(name=var)+
    labs(x=var)
print(g)

# g <- ggplot(data, aes(y=data[,target], x=data[,var], colour=data[,var], fill=data[,var])) +
#   geom_boxplot(alpha=0.5, outlier.alpha=0)+geom_jitter(width=0.25)+
#   stat_summary(fun=mean, colour="black", geom="point",shape=18, size=3)+
#   scale_color_discrete(name=var) + scale_fill_discrete(name=var)+
#   labs(x=var, y=target, title = paste(target, "vs", var))
# print(g)

# boxplot <- function(data, target, var)
```


## Numerical variables

```{r}

```


## Categroical variables

```{r}

```

